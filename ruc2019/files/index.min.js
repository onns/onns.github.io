/*!
 * Powered by uglifiyJS v2.6.1, Build by http://tool.uis.cc/jsmin/
 * build time: Sun Sep 17 2017 11:48:37 GMT+0300 (FLE 夏令时)
 */
$(document).ready(function() {
    function e(e) {
        var t = new Image;
        return t.crossOrigin = "*", t.src = e, t
    }
    var t, a = document.getElementById("image"),
        n = window.URL || window.webkitURL,
        i = (document.getElementById("actions"), {
            aspectRatio: 1,
            preview: ".imgPreview",
            rotatable: !1
        }),
        r = !1;
    const o = "./files/image/",
        l = ".png";
    var c, d, s;
    $(".jumbotron .btn-tpl:not(.disabled)").each(
            function() {
                var e = $(this).html(),
                    t = o + e + l;
                $(this).css("background-image", "url(" + t + ")")
            }),
        $(".jumbotron button:not(.disabled)").click(function() {
            $("#avatarPreview").attr("src", null),
            $("#avatarPreview").attr("alt", "\u6a21\u677f\u8f7d\u5165\u4e2d"),
            c = $(this).html(),
            d = o + c + l,
            s = e(d),
            console.log(s.src)
            s.onload = function() {
                $("#avatarPreview").attr("src", s.src)
            }, $("#imgSpace").removeClass("hidden"), document.getElementById("imgSpace").scrollIntoView()
        }), n ? $("#inputImage").change(function() {
            var e, o = this.files;
            o && o.length && (e = o[0], /^image\/\w+/.test(e.type) ? (t && n.revokeObjectURL(t), a.src = t = n.createObjectURL(e), r && r.destroy(), r = new Cropper(a, i), $("#generateImage").removeClass("disabled")) : window.alert("\u8bf7\u9009\u62e9\u56fe\u7247\u6587\u4ef6\uff01"))
        }) : (inputImage.disabled = !0, inputImage.parentNode.className += " disabled"), $("#generateImage").click(function() {
            if (!$(this).hasClass("disabled")) {
                $("#outputImage").attr("src", null);
                const e = 640;
                var t = r.getData(),
                    a = t.width,
                    n = t.x,
                    i = t.y,
                    o = e / a,
                    l = r.getImageData(),
                    c = l.naturalHeight,
                    d = l.naturalWidth,
                    m = document.getElementById("myCanvas");
                m.width = m.height = e;
                var u = m.getContext("2d");
                u.fillStyle = "#fff", u.fillRect(0, 0, e, e);
                var g = document.getElementById("image");
                u.drawImage(g, -n * o, -i * o, d * o, c * o), u.drawImage(s, 0, 0, e, e);
                var v = document.getElementById("outputImage");
                v.src = m.toDataURL(""), $("#outputSpace").removeClass("hidden"), document.getElementById("outputSpace").scrollIntoView()
            }
        })
});